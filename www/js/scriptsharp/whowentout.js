// whowentout.js
(function(){
Type.registerNamespace('PusherApi');PusherApi.ConnectionState=function(){};PusherApi.ConnectionState.prototype = {initialized:'initialized',connecting:'connecting',connected:'connected',unavailable:'unavailable',failed:'failed',disconnected:'disconnected'}
PusherApi.ConnectionState.registerEnum('PusherApi.ConnectionState',false);PusherApi.Channel=function(channelJs){this.$0=channelJs;this.$0.bind('pusher:subscription_succeeded',function($p1_0){
console.log('succeeded****');});this.$0.bind('pusher:subscription_failed',function($p1_0){
console.log('failed***');});}
PusherApi.Channel.prototype={$0:null,bind:function(eventName,handler){this.$0.bind(eventName,handler);},trigger:function(eventName,data){return this.$0.trigger(eventName,data);}}
PusherApi.Connection=function(connectionJs){this.$2=connectionJs;this.$2.bind('state_change',ss.Delegate.create(this,this.$3));}
PusherApi.Connection.prototype={add_stateChange:function(value){this.$0=ss.Delegate.combine(this.$0,value);},remove_stateChange:function(value){this.$0=ss.Delegate.remove(this.$0,value);},$0:null,add_connected:function(value){this.$1=ss.Delegate.combine(this.$1,value);},remove_connected:function(value){this.$1=ss.Delegate.remove(this.$1,value);},$1:null,$2:null,get_state:function(){return this.$4(this.$2.state);},$3:function($p0){var $0=this.$4($p0.current);var $1=this.$4($p0.previous);if(this.$1!=null&&$0==='connected'){this.$1(this,ss.EventArgs.Empty);}if(this.$0!=null){this.$0(this,new PusherApi.StateChangeEventArgs($1,$0));}},$4:function($p0){var $0=$p0;switch($0){case 'initialized':return 'initialized';case 'connecting':return 'connecting';case 'connected':return 'connected';case 'unvailable':return 'unavailable';case 'failed':return 'failed';case 'disconnected':return 'disconnected';default:throw new Error('Invalid state.');}}}
PusherApi.StateChangeEventArgs=function(previous,current){PusherApi.StateChangeEventArgs.initializeBase(this);this.set_previous(previous);this.set_current(current);}
PusherApi.StateChangeEventArgs.prototype={$1_0:null,get_previous:function(){return this.$1_0;},set_previous:function(value){this.$1_0=value;return value;},$1_1:null,get_current:function(){return this.$1_1;},set_current:function(value){this.$1_1=value;return value;}}
PusherApi.PusherClient=function(applicationKey){this.$1={};this.$0=new Pusher(applicationKey);this.set_connection(new PusherApi.Connection(this.$0.connection));}
PusherApi.PusherClient.prototype={$0:null,$2:null,get_connection:function(){return this.$2;},set_connection:function(value){this.$2=value;return value;},subscribe:function(channelName){console.log(String.format('subscribing to {0}',channelName));this.$0.subscribe(channelName);this.$3(channelName);},unsubscribe:function(channelName){this.$0.unsubscribe(channelName);delete this.$1[channelName];},$3:function($p0){var $0=this.$0.channel($p0);if($0==null){return null;}if(!Object.keyExists(this.$1,$p0)){this.$1[$p0]=new PusherApi.Channel($0);}return this.$1[$p0];},get_item:function(channelName){return this.$3(channelName);}}
Type.registerNamespace('whowentout');whowentout.ConsoleLogJob=function(message){whowentout.ConsoleLogJob.initializeBase(this);this.$0=message;}
whowentout.ConsoleLogJob.prototype={$0:null,run:function(){console.log(this.$0);return null;}}
whowentout.CountJob=function(name,n){whowentout.CountJob.initializeBase(this);this.$2=name;this.$0=n;this.$1=0;}
whowentout.CountJob.prototype={$0:0,$1:0,$2:null,run:function(){var $0=$.Deferred();var $1=0;$1=window.setInterval(ss.Delegate.create(this,function(){
console.log(String.format('{0}: {1}',this.$2,this.$1));console.log(String.format('cur = {0}, target = {1}',this.$1,this.$0));this.$1++;if(this.$1>this.$0){window.clearInterval($1);$0.resolve();}}),100);return $0;}}
window.$0=function($p0,$p1){console.log($p1.get_current());}
Type.registerNamespace('whowentout.lib');whowentout.lib.JobQueueStatus=function(){};whowentout.lib.JobQueueStatus.prototype = {idle:1,busy:2}
whowentout.lib.JobQueueStatus.registerEnum('whowentout.lib.JobQueueStatus',false);whowentout.lib.Job=function(){}
whowentout.lib.JobQueue=function(){this.$3=[];this.$5=1;}
whowentout.lib.JobQueue.prototype={add_jobStart:function(value){this.$0=ss.Delegate.combine(this.$0,value);},remove_jobStart:function(value){this.$0=ss.Delegate.remove(this.$0,value);},$0:null,add_jobComplete:function(value){this.$1=ss.Delegate.combine(this.$1,value);},remove_jobComplete:function(value){this.$1=ss.Delegate.remove(this.$1,value);},$1:null,add_statusChanged:function(value){this.$2=ss.Delegate.combine(this.$2,value);},remove_statusChanged:function(value){this.$2=ss.Delegate.remove(this.$2,value);},$2:null,$4:null,get_currentJob:function(){return this.$4;},get_count:function(){return this.$3.length;},get_status:function(){return this.$5;},set_status:function(value){if(this.$5!==value){var $0=this.$5;var $1=value;this.$5=$1;if(this.$2!=null){this.$2(this,new whowentout.lib.JobQueueStatusChangedEventArgs($0,$1));}}return value;},clear:function(){this.$3.clear();},add:function(job){this.$3.enqueue(job);},run:function(){if(this.get_status()===2){return;}this.set_status(2);this.$6();},$6:function(){if(!this.get_count()){this.set_status(1);return;}this.$4=this.$3.dequeue();if(this.$0!=null){this.$0(this,new whowentout.lib.JobEventArgs(this.$4));}var $0=this.$4.run();if(this.$7($0)){var $1=$0;var $2=ss.Delegate.create(this,function(){
this.$4=null;if(this.$1!=null){this.$1(this,new whowentout.lib.JobEventArgs(this.$4));}window.setTimeout(ss.Delegate.create(this,this.$6),0);});$1.then($2,$2);}else{window.setTimeout(ss.Delegate.create(this,this.$6),0);}},$7:function($p0){return $p0!=null&&$p0.then!=null;}}
whowentout.lib.JobEventArgs=function(job){whowentout.lib.JobEventArgs.initializeBase(this);this.$1_0=job;}
whowentout.lib.JobEventArgs.prototype={$1_0:null,get_job:function(){return this.$1_0;}}
whowentout.lib.JobQueueStatusChangedEventArgs=function(oldStatus,newStatus){whowentout.lib.JobQueueStatusChangedEventArgs.initializeBase(this);this.$1_0=oldStatus;this.$1_1=newStatus;}
whowentout.lib.JobQueueStatusChangedEventArgs.prototype={$1_0:0,$1_1:0,get_oldStatus:function(){return this.$1_0;},get_newStatus:function(){return this.$1_1;}}
PusherApi.Channel.registerClass('PusherApi.Channel');PusherApi.Connection.registerClass('PusherApi.Connection');PusherApi.StateChangeEventArgs.registerClass('PusherApi.StateChangeEventArgs',ss.EventArgs);PusherApi.PusherClient.registerClass('PusherApi.PusherClient');whowentout.lib.Job.registerClass('whowentout.lib.Job');whowentout.ConsoleLogJob.registerClass('whowentout.ConsoleLogJob',whowentout.lib.Job);whowentout.CountJob.registerClass('whowentout.CountJob',whowentout.lib.Job);whowentout.lib.JobQueue.registerClass('whowentout.lib.JobQueue');whowentout.lib.JobEventArgs.registerClass('whowentout.lib.JobEventArgs',ss.EventArgs);whowentout.lib.JobQueueStatusChangedEventArgs.registerClass('whowentout.lib.JobQueueStatusChangedEventArgs',ss.EventArgs);(function(){var $0=new PusherApi.PusherClient('805af8a6919abc9fb047');$0.get_connection().add_stateChange($0);$0.subscribe('woo');$0.get_item('woo').bind('stuff',function($p1_0){
alert($p1_0.toString());console.log($p1_0);});$('a').live('click',function($p1_0){
$p1_0.preventDefault();});})();
})();// This script was generated using Script# v0.7.4.0
