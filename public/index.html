<!DOCTYPE html>
<html>
  <head>
      <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
      <script type="text/javascript" src="http://www.netgrow.com.au/assets/files/jquery_plugins/jquery.dump.js"></script>

      <script>

          var token = 'AAACEdEose0cBAMWhZCoQV9C47HhqpSoZBPEZA7ePXH386CCjHIAt6EjPOMTxJiaHYD5oiiSBGRtc09lp9yZAaPGhYDRU6cXOIyU2dpYo3gZDZD';

          function request(type, url, data) {
              data = data || {};
              data.token = token;

              var requestParameters = {
                url: '/api/v1/' + url,
                type: type,
                dataType: 'json',
                data: data
              };

              var ajaxRequest = $.ajax(requestParameters);
              ajaxRequest.success(function(response) {
                  response.request = requestParameters;
                  $.dump(response);
              });
              ajaxRequest.error(function(response) {
                  response.request = requestParameters;
                  $.dump(response);
              });
              return ajaxRequest;
          }

          function get(url, data) {
              return request('GET', url, data);
          }

          function post(url, data) {
              return request('POST', url, data);
          }

          function get_current_user() {
              get('users/me');
          }

          function get_user(user_id) {
              get('users/' + user_id);
          }

          function update_location(longitude, latitude) {
              post('location', {
                  longitude: longitude,
                  latitude: latitude
              });
          }

          function register_push_token(iphone_push_token) {
              post('push/register', {
                  iphone_push_token: iphone_push_token
              });
          }

          function get_location() {
              get('location');
          }

          function get_nearby() {
              get('nearby');
          }

          function get_conversation(conversation_id) {
              get('conversations/' + conversation_id);
          }

          function send_message(conversation_id, body) {
              post('conversations/' + conversation_id + '/send', {
                  body: body
              });
          }

          function get_smile_game(smile_game_id) {
              get('smile-games/' + smile_game_id);
          }

          function get_smile_games_sent() {
              get('smile-games/sent');
          }

          function get_smile_games_received() {
              get('smile-games/received');
          }

          function start_smile_game(user_id) {
              post('users/' + user_id + '/start-smile-game');
          }

      </script>
  </head>

  <body>
  </body>
</html>
